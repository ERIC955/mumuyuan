import{_ as u,g as b,c as l,a as s,t as n,F as _,h as f,o as r,p as g,f as x}from"./index-OLdlyzsC.js";const v={data(){return{userInfo:{},coupons:[],choose:{}}},created(){this.$axios.get("/coupons?isLook=true").then(t=>{this.coupons=t.data,this.getUserInfo()})},methods:{getUserInfo(){this.$axios.get(`/users/${b.getItem("id")}`).then(t=>{this.userInfo=t.data})},chooseDiscount(t){this.choose=t},confirm(t){const{id:c,name:h,calc:p,image:e,description:i}=t,o=this.userInfo.point-t.point;let d=this.userInfo.coupon;d.push({id:c,name:h,calc:p,image:e,description:i}),this.$axios.patch(`/users/${this.userInfo.id}`,{point:o,coupon:d}).then(m=>{m.status===200&&(this.getUserInfo(),this.$swal({icon:"success",title:"兌換成功",text:"請確認兌換券",timer:1500}))}).catch(()=>{this.$swal({icon:"error",title:"兌換失敗",text:"請稍後再試",timer:3e3})})}}},a=t=>(g("data-v-bd5c034f"),t=t(),x(),t),y=a(()=>s("h3",{class:"text-center text-dark",style:{"font-weight":"600","letter-spacing":"2px"}},"點數兌換",-1)),I=a(()=>s("hr",null,null,-1)),k={class:"row justify-content-center memberexchange"},w={class:"col-12 mb-4"},C={class:"fw-bolder px-2",style:{"letter-spacing":"1px",color:"#d73e2dd4"}},$=a(()=>s("hr",null,null,-1)),L={class:"d-flex flex-wrap"},M=["src"],S={class:"card-body p-2 bg-light"},j={class:"fw-bolder fs-5 text-dark mb-2"},B={class:"text-start mb-3 text-dark",style:{"font-size":"18px","font-weight":"600"}},D={class:"row d-flex justify-content-center"},U={class:"col-auto"},E=["onClick","disabled"],F={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},z={class:"modal-dialog modal-dialog-centered"},N={class:"modal-content"},V=a(()=>s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"exampleModalLabel"},"點數兌換"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),q={class:"modal-body"},A={class:"modal-footer"},G=a(()=>s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1));function H(t,c,h,p,e,i){return r(),l(_,null,[y,I,s("div",k,[s("div",w,[s("h5",C,"會員點數："+n(e.userInfo.point)+" 點",1),$,s("div",L,[(r(!0),l(_,null,f(e.coupons,o=>(r(),l("div",{class:"mb-4 col-lg-4 col-6 p-2",key:o.name},[s("img",{src:`./木木苑食材修圖/${o.image}.jpg`,class:"card-img-top",alt:"image error"},null,8,M),s("div",S,[s("h5",j,"優惠方式 : "+n(o.name),1),s("p",B,"需求點數 : "+n(o.point)+" 點",1),s("div",D,[s("div",U,[s("button",{type:"button",class:"btn btn-primary items-center","data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:d=>i.chooseDiscount(o),disabled:e.userInfo.point<o.point}," 兌換 ",8,E)])])])]))),128))]),s("div",F,[s("div",z,[s("div",N,[V,s("div",q," 是否使用 "+n(e.choose.point)+" 點兌換 "+n(e.choose.name)+" 1 "+n(e.choose.unit),1),s("div",A,[G,s("button",{type:"button",class:"btn btn-primary",onClick:c[0]||(c[0]=o=>i.confirm(e.choose)),"data-bs-dismiss":"modal"}," 確認 ")])])])])])])],64)}const K=u(v,[["render",H],["__scopeId","data-v-bd5c034f"]]);export{K as default};
