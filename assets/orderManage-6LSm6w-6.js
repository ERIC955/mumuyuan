import{_ as x,r as w,o as _,c as h,a as s,s as f,b as m,d as S,F as y,t as a,e as c,h as g,j as B,T as C,p as F,f as N}from"./index-OLdlyzsC.js";import{B as I}from"./BackendFunctions-DQ4gnSdy.js";import{s as O}from"./selectList-wWYjyEHr.js";const E={components:{BackendFunctions:I,selectList:O},data(){return{order:[],finishorder:[],select:"1",options:[{value:"1",label:"待確認訂單"},{value:"2",label:"待完成訂單"}],options2:[{value:"2",label:"待完成訂單"},{value:"1",label:"待確認訂單"}],socket:null,messages:[]}},computed:{},methods:{ok(i,l,t){const u={status:2},e={userId:l,orderId:i},r=2;this.$axios.post("notice",e).then(b=>this.$axios.patch(`/orders/${i}`,u)).then(b=>{location.reload()}).catch(b=>{console.log(b.response)}),this.socket.send(JSON.stringify({status:r,num:t,userId:l}))},reject(i){this.$axios.delete(`/orders/${i}`),location.reload()},get(i){this.select=i},pushForCustomer(i,l,t){const u={status:3},e=3;this.$axios.patch(`/orders/${i}`,u).then(r=>{location.reload()}).catch(r=>{}),this.socket.send(JSON.stringify({status:e,num:t,userId:l}))}},mounted(){this.$axios.get("/orders").then(l=>{l.data.forEach(t=>{const u=[];let e="",r="";t.product.forEach(b=>{u.push(b.productName+"X"+b.quantity)}),t.flavor==1?e="梅粉":t.flavor==2?e="秘粉":t.flavor==3&&(e="椒鹽"),t.spicy==1?r="不辣":t.spicy==2?r="小辣":t.spicy==3&&(r="大辣"),t.status==1?this.order.push({name:t.name,phone:t.phone,tableware:t.tableware,bags:t.bags,way:t.type,time:t.pickTime,payment:t.payment,remark:t.comment,total:t.price,product:u,flavor:e,spicy:r,day:t.day,id:t.id,orderNum:t.orderid,status:t.status,isMember:t.isMember,userId:t.userId,orderScore:t.orderScore}):t.status==2&&this.finishorder.push({name:t.name,phone:t.phone,tableware:t.tableware,bags:t.bags,way:t.type,time:t.pickTime,payment:t.payment,remark:t.comment,total:t.price,product:u,flavor:e,spicy:r,day:t.day,id:t.id,orderNum:t.orderid,status:t.status,isMember:t.isMember,userId:t.userId,orderScore:t.orderScore})})});const i="wss://mumuyuanserver.onrender.com/ws";this.socket=new WebSocket(i),this.socket.onopen=()=>{console.log("WebSocket connection opened")}},beforeUnmount(){this.socket&&this.socket.close()}},d=i=>(F("data-v-52ef6784"),i=i(),N(),i),T={class:"d-flex"},j={class:"sidebar border-5 border-end d-flex bg-secondary flex-column"},L={key:0,class:"main container"},M={class:"w-25 mt-5"},U={class:"card-body"},V=["id"],$={class:"accordion-item"},D=["id"],J=["data-bs-target","aria-controls"],W={class:"me-5 fs-4"},q={class:"ms-5 mt-11 fs-4"},X={class:"ms-5 mt-11 fs-4"},z=["id","aria-labelledby","data-bs-parent"],A={class:"accordion-body"},G={class:"row row-cols-2"},H={class:"col d-flex flex-wrap h-25"},K={class:"row text-center h-25 w-100"},P={class:"col"},Q={class:"table table-striped align-middle table-sm h-100"},R={class:"fs-5"},Y=d(()=>s("strong",null,"口味:",-1)),Z={class:"fs-5"},ss=d(()=>s("strong",null,"辣度:",-1)),ts={class:"fs-5"},os=d(()=>s("strong",null,"是否要餐具:",-1)),as={class:"fs-5"},ds=d(()=>s("strong",null,"是否要加購提袋:",-1)),cs={class:"fs-5"},ns=d(()=>s("strong",null,"訂購方式:",-1)),ls={class:"fs-5"},es=d(()=>s("strong",null,"預計取餐時間:",-1)),is={class:"text-danger"},rs={class:"fs-5"},_s=d(()=>s("strong",null,"付款方式:",-1)),hs={class:"fs-5"},us=d(()=>s("strong",null,"總金額:",-1)),bs={class:"fs-5"},ps=d(()=>s("strong",null,"備註:",-1)),fs=["data-bs-target"],ms=["data-bs-target"],ys=["id"],gs={class:"modal-dialog"},vs={class:"modal-content border-0"},ks=d(()=>s("div",{class:"modal-body fs-3"}," 是否接受訂單? ",-1)),ws={class:"modal-footer border-0"},xs=d(()=>s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1)),Ss=["onClick"],Bs=["id"],Cs={class:"modal-dialog"},Fs={class:"modal-content border-0"},Ns=d(()=>s("div",{class:"modal-body fs-3"}," 是否拒絕訂單? ",-1)),Is={class:"modal-footer border-0"},Os=d(()=>s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1)),Es=["onClick"],Ts={key:1,class:"main container"},js={class:"w-25 mt-5"},Ls={class:"card-body"},Ms={class:"accordion accordion-flush",id:"accordionFlushExample"},Us={class:"accordion-item"},Vs=["id"],$s=["data-bs-target"],Ds={class:"me-5 fs-4"},Js={class:"ms-5 mt-11 fs-4"},Ws=["id","aria-labelledby"],qs={class:"accordion-body"},Xs={class:"row row-cols-2"},zs={class:"col d-flex flex-wrap h-25"},As={class:"row row-cols-4 text-center h-25 w-100"},Gs={class:"col"},Hs={class:"table table-striped align-middle table-sm h-100"},Ks={class:"fs-5"},Ps=d(()=>s("strong",null,"口味:",-1)),Qs={class:"fs-5"},Rs=d(()=>s("strong",null,"辣度:",-1)),Ys={class:"fs-5"},Zs=d(()=>s("strong",null,"是否要餐具:",-1)),st={class:"fs-5"},tt=d(()=>s("strong",null,"是否要加購提袋:",-1)),ot={class:"fs-5"},at=d(()=>s("strong",null,"訂購方式:",-1)),dt={class:"fs-5"},ct=d(()=>s("strong",null,"預計取餐時間:",-1)),nt={class:"text-danger"},lt={class:"fs-5"},et=d(()=>s("strong",null,"付款方式:",-1)),it={class:"fs-5"},rt=d(()=>s("strong",null,"總金額:",-1)),_t={class:"fs-5"},ht=d(()=>s("strong",null,"備註:",-1)),ut=["data-bs-target"],bt=["id"],pt={class:"modal-dialog"},ft={class:"modal-content border-0"},mt=d(()=>s("div",{class:"modal-body fs-3"}," 是否完成訂單? ",-1)),yt={class:"modal-footer border-0"},gt=d(()=>s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1)),vt=["onClick"];function kt(i,l,t,u,e,r){const b=w("BackendFunctions"),k=w("select-list");return _(),h("div",T,[s("aside",j,[l[0]||(f(-1),l[0]=m(b),f(1),l[0])]),m(C,{name:"fade",mode:"out-in"},{default:S(()=>[e.select==1?(_(),h("main",L,[s("div",M,[l[1]||(f(-1),l[1]=m(k,{options:e.options,onUpdata:r.get},null,8,["options","onUpdata"]),f(1),l[1])]),(_(!0),h(y,null,g(e.order,(o,n)=>(_(),h("div",{class:"card mt-2 shadow-sm w-100 mb-3",key:n},[s("div",U,[s("div",{class:"accordion accordion-flush",id:"accordionFlushExample"+n},[s("div",$,[s("h2",{class:"accordion-header",id:"flush-heading"+n},[s("button",{class:"accordion-button collapsed shadow-none",type:"button","data-bs-toggle":"collapse","data-bs-target":"#flush-collapseOne"+n,"aria-expanded":"false","aria-controls":"flush-collapseOne"+n},[s("strong",W,a(o.name),1),c(),s("span",q,"手機:"+a(o.phone),1),s("span",X,"日期:"+a(o.day),1)],8,J)],8,D),s("div",{id:"flush-collapseOne"+n,class:"accordion-collapse collapse","aria-labelledby":"flush-heading"+n,"data-bs-parent":"#accordionFlushExample"+n},[s("div",A,[s("div",G,[s("div",H,[s("div",K,[(_(!0),h(y,null,g(o.product,(p,v)=>(_(),h("div",{class:"col-4 fs-4 text-nowrap",key:v},a(p),1))),128))])]),s("div",P,[s("table",Q,[s("tbody",null,[s("tr",null,[s("td",R,[Y,c(a(o.flavor),1)])]),s("tr",null,[s("td",Z,[ss,c(a(o.spicy),1)])]),s("tr",null,[s("td",ts,[os,c(a(o.tableware?"要":"不要"),1)])]),s("tr",null,[s("td",as,[ds,c(a(o.bags?"要":"不要"),1)])]),s("tr",null,[s("td",cs,[ns,c(a(o.way?"自取":"外送"),1)])]),s("tr",null,[s("td",ls,[es,s("span",is,a(o.time),1)])]),s("tr",null,[s("td",rs,[_s,c(a(o.payment?"現金":"線上付款"),1)])]),s("tr",null,[s("td",hs,[us,c(a(o.total),1)])]),s("tr",null,[s("td",bs,[ps,c(a(o.remark),1)])])]),s("tfoot",null,[s("button",{type:"btn",class:"btn btn-primary w-100 mb-1","data-bs-toggle":"modal","data-bs-target":"#ok"+n},"接受",8,fs),s("button",{type:"btn",class:"btn btn-primary w-100 mt-1","data-bs-toggle":"modal","data-bs-target":"#reject"+n},"拒絕",8,ms)])])])])])],8,z)])],8,V),s("div",{class:"modal fade",id:"ok"+n,"data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},[c("0 "),s("div",gs,[s("div",vs,[ks,s("div",ws,[xs,s("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:p=>r.ok(o.id,o.userId,o.orderNum)},"確認",8,Ss)])])])],8,ys),s("div",{class:"modal fade",id:"reject"+n,"data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},[c("0 "),s("div",Cs,[s("div",Fs,[Ns,s("div",Is,[Os,s("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:p=>r.reject(o.id)},"確認",8,Es)])])])],8,Bs)])]))),128))])):e.select==2?(_(),h("main",Ts,[s("div",js,[l[2]||(f(-1),l[2]=m(k,{options:e.options2,onUpdata:r.get},null,8,["options","onUpdata"]),f(1),l[2])]),(_(!0),h(y,null,g(e.finishorder,(o,n)=>(_(),h("div",{class:"card mt-2 shadow-sm w-100",key:n},[s("div",Ls,[s("div",Ms,[s("div",Us,[s("h2",{class:"accordion-header",id:"flush-heading"+n},[s("button",{class:"accordion-button collapsed shadow-none",type:"button","data-bs-toggle":"collapse","data-bs-target":"#flush-collapseOne"+n,"aria-expanded":"false","aria-controls":"flush-collapseOne"},[s("strong",Ds,a(o.name),1),c(),s("span",Js,"手機:"+a(o.phone),1)],8,$s)],8,Vs),s("div",{id:"flush-collapseOne"+n,class:"accordion-collapse collapse","aria-labelledby":"flush-heading"+n,"data-bs-parent":"#accordionFlushExample"},[s("div",qs,[s("div",Xs,[s("div",zs,[s("div",As,[(_(!0),h(y,null,g(o.product,(p,v)=>(_(),h("div",{class:"col-4 fs-4 text-nowrap",key:v},a(p),1))),128))])]),s("div",Gs,[s("table",Hs,[s("tbody",null,[s("tr",null,[s("td",Ks,[Ps,c(a(o.flavor),1)])]),s("tr",null,[s("td",Qs,[Rs,c(a(o.spicy),1)])]),s("tr",null,[s("td",Ys,[Zs,c(a(o.tableware?"要":"不要"),1)])]),s("tr",null,[s("td",st,[tt,c(a(o.bags?"要":"不要"),1)])]),s("tr",null,[s("td",ot,[at,c(a(o.way?"自取":"外送"),1)])]),s("tr",null,[s("td",dt,[ct,s("span",nt,a(o.time),1)])]),s("tr",null,[s("td",lt,[et,c(a(o.payment?"現金":"線上付款"),1)])]),s("tr",null,[s("td",it,[rt,c(a(o.total),1)])]),s("tr",null,[s("td",_t,[ht,c(a(o.remark),1)])])]),s("tfoot",null,[s("button",{type:"btn",class:"btn btn-primary w-100 mt-1","data-bs-toggle":"modal","data-bs-target":"#finish"+n},"完成",8,ut)])])])])])],8,Ws)])]),s("div",{class:"modal fade",id:"finish"+n,"data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},[c("0 "),s("div",pt,[s("div",ft,[mt,s("div",yt,[gt,s("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:p=>r.pushForCustomer(o.id,o.userId,o.orderNum)},"確認",8,vt)])])])],8,bt)])]))),128))])):B("",!0)]),_:1})])}const Bt=x(E,[["render",kt],["__scopeId","data-v-52ef6784"]]);export{Bt as default};
